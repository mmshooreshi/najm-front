<!-- components/sections/FaqSec.vue -->
<template>
  <section :dir="isRTL ? 'rtl' : 'ltr'" class="pt-16">
    <div class="max-w-4xl mx-auto flex flex-col gap-12 overflow-visible">
      <!-- Title -->
      <h2 class="text-lg md:text-xl font-bold text-center">
        {{ data.heading }}
      </h2>

      <!-- Category Tabs -->
      <div class="relative h-8 lg:h-28">
        <div ref="tabsContainer"
          class="tabs-container absolute   sm:w-screen lg:max-w-full  flex flex-nowrap lg:flex-wrap gap-2 whitespace-nowrap lg:whitespace-normal overflow-x-auto lg:overflow-visible py-2 justify-start sm:px-4 w-max lg:justify-center ">
          <button v-for="(cat, i) in data.categories" :key="cat.name" @click="selectTab(i)" :class="[
            'rounded-3xl border text-demibold text-xs px-6 py-3 transition-colors',
            activeTab === i
              ? 'border-[#C2D3D1] bg-najmgreen/20 text-najmgreen'
              : 'border-[#C2D3D1] text-gray-700 bg-transparent hover:bg-gray-200'
          ]">
            {{ cat.name }}
          </button>
        </div>
      </div>


      <ClientOnly>
        <div :key="renderKey">

          <!-- FAQ List -->
          <div class="divide-y-0.5  divide-najmborder    -mt-6 px-6 max-h-[50vh] overflow-auto">

            <!-- <div class="grid grid-cols-3 divide-x divide-gray-400">
  <div class="text-center">1</div>
  <div class="text-center">2</div>
  <div class="text-center">3</div>
</div> -->
            <div v-for="(item, idx) in data.categories[activeTab].items" :key="item.key" :class="{ 'py-0': idx !== 0 }">
              <FaqItem :index="idx" :question="item.question" :answer="item.answer" :open="activeItem === idx"
                @toggle="activeItem = activeItem === idx ? null : idx" />
            </div>

          </div>
        </div>
      </ClientOnly>
    </div>
  </section>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import FaqItem from '@/components/Base/BaseFaqItem.vue'

const { language } = useLocale()
const isRTL = computed(() => language.value === 'FA' || language.value === 'AR')

interface Category {
  name: string
  items: {
    key: number
    question: string
    answer: string
  }[]
}

// interface FaqItemType {
//   question: string
//   answer:   string
//   key: number
// }
// interface Category {
//   name:  string
//   items: FaqItemType[]
// }

// const categories = ref<Category[]>([
//     {
//       name: 'همکاری و قراردادها',
//       items: [
//         {
//           key: 1,
//           question: 'چگونه می‌توانم سفارش خود را ثبت کنم؟',
//           answer:
//             'برای ثبت سفارش کافیست از طریق فرم سفارش آنلاین اطلاعات لازم را وارد کرده و ارسال نمایید. تیم ما در سریع‌ترین زمان با شما تماس خواهد گرفت.'
//         },
//         {
//           key: 2,
//           question: 'حداقل تعداد سفارش چقدر است؟',
//           answer:
//             'حداقل تعداد سفارش به نوع محصول و فرآیند تولید بستگی دارد. لطفاً با بخش فروش تماس بگیرید تا شرایط دقیق را بررسی کنیم.'
//         },
//         {
//           key: 3,
//           question: 'آیا امکان تغییر یا لغو سفارش وجود دارد؟',
//           answer:
//             'بله، امکان تغییر یا لغو سفارش وجود دارد، اما باید این درخواست را پیش از شروع فرآیند تولید ثبت کنید. پس از آغاز تولید، تغییر یا لغو ممکن است مشمول هزینه شود.'
//         },
//         {
//           key: 4,
//           question: 'چگونه می‌توانم وضعیت سفارش خود را پیگیری کنم؟',
//           answer:
//             'وضعیت سفارش خود را می‌توانید از طریق پنل کاربری یا لینک پیگیری که پس از ثبت سفارش برای شما ارسال می‌شود، مشاهده کنید.'
//         }
//       ]
//     },
//     {
//       name: 'پشتیبانی و خدمات پس از فروش',
//       items: [
//         {
//           key: 5,
//           question: 'آیا امکان تغییر یا لغو سفارش وجود دارد؟',
//           answer:
//             'بله، امکان تغییر یا لغو سفارش وجود دارد، اما باید این درخواست را پیش از شروع فرآیند تولید ثبت کنید. پس از آغاز تولید، تغییر یا لغو ممکن است مشمول هزینه شود.'
//         },
//         {
//           key: 6,
//           question: 'چگونه می‌توانم وضعیت سفارش خود را پیگیری کنم؟',
//           answer:
//             'وضعیت سفارش خود را می‌توانید از طریق پنل کاربری یا لینک پیگیری که پس از ثبت سفارش برای شما ارسال می‌شود، مشاهده کنید.'
//         }
//       ]
//     },
//     {
//       name: 'مواد و کیفیت',
//       items: [
//         {
//           key: 7,
//           question: 'چه نوع موادی استفاده می‌کنید؟',
//           answer:
//             'ما از باکیفیت‌ترین مواد اولیه داخلی و وارداتی استفاده می‌کنیم که استانداردهای جهانی را پاس می‌کنند.'
//         }
//       ]
//     },
//     {
//       name: 'طراحی و مشاوره',
//       items: [
//         {
//           key: 8,
//           question: 'آیا خدمات طراحی هم ارائه می‌دهید؟',
//           answer:
//             'بله، تیم طراحی ما آماده است تا براساس نیاز شما طرح‌های اختصاصی آماده کند و پس از تأیید شما پیش برود.'
//         }
//       ]
//     },
//     {
//       name: 'قیمت‌گذاری و پرداخت',
//       items: [
//         {
//           key: 9,
//           question: 'روش‌های پرداخت چیست؟',
//           answer:
//             'شما می‌توانید از طریق درگاه آنلاین، انتقال بانکی یا پرداخت در محل (در صورت امکان) هزینه سفارش را تسویه کنید.'
//         }
//       ]
//     },
//     {
//       name: 'زمان و تحویل',
//       items: [
//         {
//           key: 10,
//           question: 'مدت زمان تحویل چقدر است؟',
//           answer:
//             'زمان تحویل بسته به حجم و نوع سفارش متغیر است، اما معمولاً بین ۷ تا ۱۴ روز کاری است.'
//         }
//       ]
//     },
//     {
//       name: 'فرآیند سفارش',
//       items: [
//         {
//           key: 11,
//           question: 'فرآیند تولید از چه مراحلی تشکیل شده است؟',
//           answer:
//             'پس از ثبت سفارش: طراحی – تأیید طرح – تولید نمونه – تولید نهایی – بسته‌بندی و ارسال.'
//         }
//       ]
//     },
//     {
//       name: 'خدمات مجموعه',
//       items: [
//         {
//           key: 12,
//           question: 'آیا خدمات نصب دارید؟',
//           answer:
//             'بله، در صورت نیاز می‌توانیم تیم نصب را به محل شما اعزام کنیم (هزینه جداگانه).'
//         }
//       ]
//     }
//   ])


const categoriesPrev = ref<Category[]>([
  {
    name: 'خدمات چاپ و بسته‌بندی',
    items: [
      {
        key: 1,
        question: 'چه نوع خدمات چاپی ارائه می‌دهید؟',
        answer:
          'ما انواع خدمات چاپ افست، دیجیتال، سیلک اسکرین و چاپ UV را ارائه می‌دهیم که مناسب چاپ روی کاغذ، مقوا و مواد خاص است.'
      },
      {
        key: 2,
        question: 'آیا امکان طراحی سفارشی وجود دارد؟',
        answer:
          'بله، تیم طراحی ما می‌تواند طرح‌های اختصاصی شما را از صفر تا صد آماده کند و مطابق سلیقه شما ویرایش نماید.'
      },
      {
        key: 3,
        question: 'چه نوع بسته‌بندی‌هایی را پوشش می‌دهید؟',
        answer:
          'جعبه‌های مقوایی، بسته‌بندی‌های انعطاف‌پذیر، پاکت‌های کرافت، لفاف‌های چندلایه و بسته‌بندی ضدآب از جمله خدمات ما هستند.'
      },
      {
        key: 4,
        question: 'آیا امکان چاپ نمونه قبل از تولید انبوه وجود دارد؟',
        answer:
          'بله، پس از تأیید نهایی طرح، یک نمونه چاپی برای شما ارسال می‌شود تا از کیفیت و رنگ‌بندی نهایی مطمئن شوید.'
      },
      {
        key: 5,
        question: 'آیا خدمات چاپ روی مواد خاص (مثل پلاستیک، فلز، چرم) را ارائه می‌دهید؟',
        answer:
          'بله، با استفاده از تکنولوژی‌های خاص قادر به چاپ روی پلاستیک، فلز، چرم و سایر سطوح صاف هستیم.'
      }
    ]
  },
  {
    name: 'فرآیند سفارش',
    items: [
      {
        key: 6,
        question: 'چگونه می‌توانم سفارش خود را ثبت کنم؟',
        answer:
          'برای ثبت سفارش، فرم آنلاین ما را تکمیل کرده یا با تیم فروش تماس بگیرید تا مراحل اولیه را راهنمایی کنند.'
      },
      {
        key: 7,
        question: 'حداقل تعداد سفارش چقدر است؟',
        answer:
          'حداقل تیراژ بسته به نوع محصول متفاوت است؛ معمولاً از ۵۰۰ عدد برای چاپ افست و از ۱۰۰ عدد برای چاپ دیجیتال شروع می‌شود.'
      },
      {
        key: 8,
        question: 'چه اطلاعاتی برای ثبت سفارش نیاز دارید؟',
        answer:
          'ابعاد نهایی، نوع کاغذ یا بسته‌بندی، تعداد تیراژ، فایل طراحی با فرمت PDF یا AI و اطلاعات تحویل مورد نیاز است.'
      },
      {
        key: 9,
        question: 'آیا امکان تغییر یا لغو سفارش وجود دارد؟',
        answer:
          'بله، تا قبل از شروع تولید می‌توانید سفارش را تغییر یا لغو کنید؛ پس از آغاز تولید، ممکن است جریمه‌ای اعمال شود.'
      },
      {
        key: 10,
        question: 'چگونه می‌توانم وضعیت سفارش خود را پیگیری کنم؟',
        answer:
          'با ورود به پنل کاربری یا از طریق لینک پیگیری که پس از ثبت سفارش برایتان ایمیل می‌شود، می‌توانید مراحل را مشاهده کنید.'
      }
    ]
  },
  {
    name: 'زمان و تحویل',
    items: [
      {
        key: 11,
        question: 'مدت زمان انجام سفارش چقدر است؟',
        answer:
          'بسته به تیراژ و نوع چاپ، معمولاً بین ۵ تا ۱۴ روز کاری زمان نیاز است.'
      },
      {
        key: 12,
        question: 'آیا خدمات چاپ فوری ارائه می‌دهید؟',
        answer:
          'بله، برای سفارش‌های فوری امکان کاهش زمان تحویل تا ۳ روز کاری وجود دارد (با هزینه اضافه).'
      },
      {
        key: 13,
        question: 'روش‌های ارسال سفارش چگونه است؟',
        answer:
          'ارسال از طریق پیک اختصاصی، پست پیشتاز یا باربری و تحویل در محل مشتری انجام می‌شود.'
      },
      {
        key: 14,
        question: 'آیا امکان ارسال سفارش به شهرهای مختلف وجود دارد؟',
        answer:
          'بله، ما برای تمامی شهرهای کشور با شرکت‌های معتبر پستی و باربری همکاری داریم.'
      },
      {
        key: 15,
        question: 'آیا می‌توانم سفارش خود را حضوری تحویل بگیرم؟',
        answer:
          'بله، در صورت تمایل می‌توانید با هماهنگی قبلی به دفتر ما مراجعه کرده و سفارش را دریافت کنید.'
      }
    ]
  },
  {
    name: 'قیمت‌گذاری و پرداخت',
    items: [
      {
        key: 16,
        question: 'قیمت‌گذاری بر چه اساسی انجام می‌شود؟',
        answer:
          'قیمت‌ها بر اساس تیراژ، نوع چاپ، تعداد رنگ، نوع مواد و پیچیدگی طرح محاسبه می‌شوند.'
      },
      {
        key: 17,
        question: 'آیا تخفیف برای سفارشات عمده دارید؟',
        answer:
          'بله، برای تیراژ بالای ۵۰۰۰ عدد یا سفارش‌های منظم تخفیف ویژه در نظر گرفته می‌شود.'
      },
      {
        key: 18,
        question: 'روش‌های پرداخت چیست؟',
        answer:
          'واریز به حساب بانکی، درگاه پرداخت آنلاین و چک بانکی (برای شرکت‌ها) پذیرفته می‌شود.'
      },
      {
        key: 19,
        question: 'آیا پرداخت به صورت اقساطی امکان‌پذیر است؟',
        answer:
          'برای مشتریان سازمانی امکان پرداخت مرحله‌ای و اقساطی با معرفی ضمانت وجود دارد.'
      },
      {
        key: 20,
        question: 'آیا هزینه‌های ارسال جداگانه محاسبه می‌شود؟',
        answer:
          'بله، هزینه ارسال بسته به وزن و مقصد توسط سیستم حمل و نقل محاسبه و به فاکتور اضافه می‌شود.'
      }
    ]
  },
  {
    name: 'طراحی و مشاوره',
    items: [
      {
        key: 21,
        question: 'آیا تیم طراحی برای کمک به ایده‌پردازی دارید؟',
        answer:
          'بله، طراحان گرافیک ما آماده ارائه ایده و مشاوره برای بهترین نمایش برند شما هستند.'
      },
      {
        key: 22,
        question: 'چه فرمت فایل‌هایی برای طراحی چاپی پذیرفته می‌شود؟',
        answer:
          'PDF، AI، EPS و PSD با رزولوشن حداقل ۳۰۰ dpi و در حالت CMYK پذیرفته می‌شود.'
      },
      {
        key: 23,
        question: 'آیا امکان بازبینی و تأیید طراحی قبل از چاپ وجود دارد؟',
        answer:
          'بله، پس از طراحی اولیه فایل خام برای شما ارسال شده و پس از تأیید، چاپ آغاز می‌شود.'
      },
      {
        key: 24,
        question: 'آیا خدمات مشاوره در انتخاب نوع چاپ و بسته‌بندی ارائه می‌دهید؟',
        answer:
          'بله، مشاوران ما بر اساس بودجه و نیاز شما بهترین متریال و روش چاپ را پیشنهاد می‌کنند.'
      },
      {
        key: 25,
        question: 'آیا خدمات اصلاح طرح گرافیکی را ارائه می‌کنید؟',
        answer:
          'بله، تا دو بار اصلاح رایگان و پس از آن با هزینه جزئی انجام می‌شود.'
      }
    ]
  },
  {
    name: 'مواد و کیفیت',
    items: [
      {
        key: 26,
        question: 'از چه موادی برای چاپ و بسته‌بندی استفاده می‌کنید؟',
        answer:
          'کاغذهای گلاسه، تحریر، مقواهای پشت‌کرایه و متریال‌های اختصاصی مانند پلاستیک و فویل آلومینیوم.'
      },
      {
        key: 27,
        question: 'آیا محصولات شما دوستدار محیط زیست هستند؟',
        answer:
          'بله، کاغذهای بازیافتی و پوشش‌های زیست‌تجزیه‌پذیر نیز در دسترس هستند.'
      },
      {
        key: 28,
        question: 'چه نوع پوشش‌هایی (لمینت، مات، براق) ارائه می‌دهید؟',
        answer:
          'لمینت مات، لمینت براق، یووی موضعی و ورنی نانو برای افزایش مقاومت و جلوه کار موجود است.'
      },
      {
        key: 29,
        question: 'آیا تضمینی برای کیفیت چاپ و بسته‌بندی وجود دارد؟',
        answer:
          'بله، ما کیفیت رنگ و دقت برش را تضمین می‌کنیم و در صورت هر گونه عدم‌رضایت، اصلاح رایگان خواهیم داشت.'
      },
      {
        key: 30,
        question: 'چگونه می‌توان کیفیت محصولات را ارزیابی کرد؟',
        answer:
          'نمونه رایگان، گزارش کنترل کیفیت و عکس‌های دیجیتال قبل از ارسال در اختیار شما قرار می‌گیرد.'
      }
    ]
  },
  {
    name: 'پشتیبانی و خدمات پس از فروش',
    items: [
      {
        key: 31,
        question: 'اگر سفارش مطابق انتظار نباشد، چه کاری انجام می‌دهید؟',
        answer:
          'در صورت بروز مشکل، اصلاح فوری و یا تولید مجدد تا جلب رضایت کامل شما انجام خواهد شد.'
      },
      {
        key: 32,
        question: 'چگونه می‌توانم با تیم پشتیبانی تماس بگیرم؟',
        answer:
          'به صورت تلفنی، واتس‌اپ و تیکت آنلاین در سایت، همه روزه پاسخگو هستیم.'
      },
      {
        key: 33,
        question: 'آیا ضمانت یا خدمات پس از فروش دارید؟',
        answer:
          'بله، تا ۳۰ روز پس از تحویل سفارش می‌توانید درخواست بازبینی یا اصلاح دهید.'
      },
      {
        key: 34,
        question: 'آیا امکان بازگشت یا تعویض سفارش وجود دارد؟',
        answer:
          'در صورت نقص یا اشتباه در سفارش، بازگشت یا تعویض کالا بدون هزینه برای شما انجام می‌شود.'
      },
      {
        key: 35,
        question: 'ساعات کاری تیم پشتیبانی چیست؟',
        answer:
          'ساعات پاسخگویی از شنبه تا پنجشنبه ۸ صبح تا ۶ عصر و جمعه‌ها ۹ صبح تا ۲ بعدازظهر است.'
      }
    ]
  },
  {
    name: 'همکاری و قراردادها',
    items: [
      {
        key: 36,
        question: 'آیا امکان همکاری بلندمدت یا عقد قرارداد وجود دارد؟',
        answer:
          'بله، بسته به حجم و دوره همکاری قراردادهای یک‌ساله با شرایط ویژه ارائه می‌شود.'
      },
      {
        key: 37,
        question: 'چه مزایایی برای مشتریان وفادار در نظر گرفته‌اید؟',
        answer:
          'تخفیفات ویژه، ارسال رایگان و اولویت چاپ برای سفارشات تکراری از مزایای وفاداری است.'
      },
      {
        key: 38,
        question: 'آیا امکان تولید بسته‌بندی با برند اختصاصی وجود دارد؟',
        answer:
          'بله، از طراحی لوگو تا چاپ و بسته‌بندی با برند شما را پوشش می‌دهیم.'
      },
      {
        key: 39,
        question: 'آیا خدمات B2B برای کسب‌وکارها ارائه می‌دهید؟',
        answer:
          'بله، همکاری با شرکت‌ها، سازمان‌ها و فروشگاه‌های اینترنتی با شرایط ویژه مالی و لجستیک امکان‌پذیر است.'
      },
      {
        key: 40,
        question: 'آیا برای صادرات نیز بسته‌بندی ارائه می‌دهید؟',
        answer:
          'بله، بسته‌بندی مقاوم به شرایط حمل‌ونقل بین‌المللی و با استانداردهای صادراتی قابل ارائه است.'
      }
    ]
  }
])





const homeUI = inject<any>('homeUI') ?? {}
const data = ref<{ heading: string; categories: Category[] }>({
  heading: '',
  categories: []
})
const activeTab = ref(0)
const activeItem = ref<number | null>(null)

watch(
  language,
  () => {
    const newData = homeUI?.value?.sceneFaq ?? {}
    data.value = {
      heading: newData.heading,
      categories: newData.categories || []
    }
    activeTab.value = 0
    activeItem.value = null
  },
  { immediate: true }
)





watch(activeTab, () => {
  activeItem.value = null
})



const tabsContainer = ref<HTMLElement | null>(null)

function selectTab(i: number) {
  activeTab.value = i
  // wait for Vue to render the new “active”
  nextTick(() => {
    const container = tabsContainer.value
    if (!container) return

    const btns = container.querySelectorAll('button')
    const btn = btns[i] as HTMLElement | undefined
    if (!btn) return

    btn.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest',  // vertical stay-put
      inline: 'start',    // scroll to left edge + our CSS margin
    })
  })

}


const renderKey = computed(() => `${language.value}-${activeTab.value}`)

</script>

<style scoped></style>
